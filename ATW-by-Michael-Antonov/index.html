<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="google-site-verification" content="rMF1JqbmMsHu2M1zSLQ482HWMOd8u-4z-zWViLWMXHg" />
<meta name="msvalidate.01" content="41CDEF49B6C0AE7EBCA90FD97E410ADE" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"treeknows.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="ç¿»è¯‘æ–‡ç« ï¼ŒåŸæ–‡é“¾æ¥ï¼šAsynchronous Timewarp Examined Written by: Michael Antonov â€¢ 2015å¹´3æœˆ3æ—¥  æ–‡ç« æ ¼å¼å®‰æ’å¦‚ä¸‹ï¼š  è‹±æ–‡åŸæ–‡  ä¸­æ–‡è¯‘æ–‡ ï¼ˆè‡ªè¨€è‡ªè¯­ï¼‰">
<meta property="og:type" content="article">
<meta property="og:title" content="ATWæ¦‚è¿°-by Michael Antonov">
<meta property="og:url" content="https://treeknows.github.io/ATW-by-Michael-Antonov/index.html">
<meta property="og:site_name" content="Hi tree">
<meta property="og:description" content="ç¿»è¯‘æ–‡ç« ï¼ŒåŸæ–‡é“¾æ¥ï¼šAsynchronous Timewarp Examined Written by: Michael Antonov â€¢ 2015å¹´3æœˆ3æ—¥  æ–‡ç« æ ¼å¼å®‰æ’å¦‚ä¸‹ï¼š  è‹±æ–‡åŸæ–‡  ä¸­æ–‡è¯‘æ–‡ ï¼ˆè‡ªè¨€è‡ªè¯­ï¼‰">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/double-image-judder.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/double-image-judder.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/multiple-image-judder-with-near-field-objects.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/multiple-image-judder-with-near-field-objects.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/moving-object-affected-by-judder.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/moving-object-affected-by-judder.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection2.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection2.jpg">
<meta property="article:published_time" content="2024-01-04T05:57:50.000Z">
<meta property="article:modified_time" content="2024-01-04T08:31:26.289Z">
<meta property="article:author" content="treeknows">
<meta property="article:tag" content="XR">
<meta property="article:tag" content="Rendering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/double-image-judder.jpg">

<link rel="canonical" href="https://treeknows.github.io/ATW-by-Michael-Antonov/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ATWæ¦‚è¿°-by Michael Antonov | Hi tree</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8W35JPL36V"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-8W35JPL36V');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hi tree</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">è¡Œæœ‰ä¸å¾—ï¼Œåæ±‚è¯¸å·±</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://treeknows.github.io/ATW-by-Michael-Antonov/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="treeknows">
      <meta itemprop="description" content="Let me grow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi tree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ATWæ¦‚è¿°-by Michael Antonov
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-01-04 13:57:50 / ä¿®æ”¹æ—¶é—´ï¼š16:31:26" itemprop="dateCreated datePublished" datetime="2024-01-04T13:57:50+08:00">2024-01-04</time>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>16 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <hr>
<p><strong>ç¿»è¯‘æ–‡ç« ï¼ŒåŸæ–‡é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://developer.oculus.com/blog/asynchronous-timewarp-examined/">Asynchronous Timewarp Examined</a></strong></p>
<p><strong>Written by: Michael Antonov â€¢ 2015å¹´3æœˆ3æ—¥</strong></p>
<hr>
<p>æ–‡ç« æ ¼å¼å®‰æ’å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>è‹±æ–‡åŸæ–‡</p>
</blockquote>
<p>ä¸­æ–‡è¯‘æ–‡</p>
<p>ï¼ˆè‡ªè¨€è‡ªè¯­ï¼‰</p>
<hr>
<span id="more"></span>
<blockquote>
<p><em><strong>TL;DR:</strong> Asynchronous timewarp (ATW) is a technique that generates intermediate frames in situations when the game canâ€™t maintain frame rate, helping to reduce judder. However, ATW is not a silver bullet and has limitations that developers should be aware of.</em></p>
</blockquote>
<p><em>Too long, donâ€™t read. å¼‚æ­¥æ—¶é—´æ‰­æ›²(ATW)æ˜¯ä¸€ç§åœ¨æ¸¸æˆæ— æ³•ä¿æŒå¸§ç‡æ—¶ç”Ÿæˆä¸­é—´å¸§çš„æŠ€æœ¯ï¼Œå¸®åŠ©å‡å°‘æŠ–åŠ¨ã€‚ç„¶è€Œï¼ŒATWå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ï¼Œå¼€å‘äººå‘˜åº”å½“çŸ¥æ™“ã€‚</em></p>
<blockquote>
<p><strong>Intro</strong></p>
<p>Over the past year thereâ€™s been a lot of excitement around asynchronous timewarp (ATW). Many hoped that ATW would allow engines to run and render at a lower frame rate, using ATW to artificially fill in dropped frames without a significant drop in the VR quality.</p>
<p>On Gear VR Innovator Edition, ATW has been a key part of delivering a great experience. Unfortunately, it turns out there are intrinsic limitations and technical challenges that prevent ATW from being a universal solution for judder on PC VR systems with positional tracking like the Rift. Under some conditions, the perceptual effects of timewarp judder in VR can be almost as bad as judder due to skipped frames.</p>
<p>In this blog, we analyze these limitations and situations that cause particular difficulties. As youâ€™ll see, while ATW may be helpful at times, there is no substitute for hitting the full frame rate when it comes to delivering great VR.</p>
</blockquote>
<p><strong>ä»‹ç»</strong></p>
<p>è¿‡å»ä¸€å¹´é‡Œäººä»¬å¯¹ATWè¡¨ç°å‡ºäº†å¾ˆå¤§çš„å…´å¥‹ã€‚è®¸å¤šäººå¸Œæœ›ATWèƒ½è®©å¼•æ“ä»¥æ›´ä½çš„å¸§ç‡è¿è¡Œå’Œæ¸²æŸ“ï¼Œåˆ©ç”¨ATWè®¤ä¸ºçš„è¡¥å……ä¸¢å¸§ï¼Œè€Œä¸ä¼šæ˜æ˜¾é™ä½VRçš„è´¨é‡ã€‚</p>
<p>åœ¨Gear VRåˆ›æ–°ç‰ˆä¸Šï¼ŒATWæˆä¸ºäº†æä¾›å‡ºè‰²ä½“éªŒçš„å…³é”®éƒ¨åˆ†ã€‚é—æ†¾çš„æ˜¯ï¼Œç”±äºå­˜åœ¨ä¸€äº›å†…åœ¨é™åˆ¶å’ŒæŠ€æœ¯éš¾é¢˜ï¼ŒATWæ— æ³•æˆä¸ºè§£å†³åƒRiftç­‰å¸¦æœ‰ä½ç½®è¿½è¸ªåŠŸèƒ½çš„PC VRç³»ç»Ÿä¸ŠæŠ–åŠ¨é—®é¢˜çš„é€šç”¨æ–¹æ¡ˆã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œåœ¨è™šæ‹Ÿç°å®ä¸­åº”ç”¨ATWåçš„æ•ˆæœå’Œç”±è·³å¸§å¼•èµ·çš„æŠ–åŠ¨æ•ˆæœä¸€æ ·ç³Ÿç³•ã€‚</p>
<p>åœ¨æœ¬åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†æè¿™äº›é™åˆ¶ä»¥åŠé€ æˆç‰¹æ®Šå›°éš¾çš„æƒ…å†µã€‚æ­£å¦‚ä½ å°†çœ‹åˆ°çš„ï¼ŒATWæœ‰æ—¶å¯èƒ½æ˜¯æœ‰å¸®åŠ©çš„ï¼Œä½†è¦æä¾›å‡ºè‰²çš„VRæ•ˆæœï¼Œå…¨å¸§ç‡æ˜¯æ— å¯æ›¿ä»£çš„ã€‚</p>
<p>ï¼ˆåº”è¯¥æ˜¯æŒ‡ï¼Œå¸§ç‡æ‹‰æ»¡çš„æ•ˆæœæ˜¯ATWæœ›å°˜è«åŠçš„ï¼‰</p>
<blockquote>
<p><strong>Timewarp, Asynchronous Timewarp, and Judder</strong></p>
<p>Timewarp is a technique that warps the rendered image before sending it to the display in order to correct for head motion that occurred after the scene was rendered and thereby reduce the perceived latency. The basic version of this is orientation-only timewarp, in which only the rotational change in the head pose is corrected for; this has the considerable advantage of being a 2D warp, so it does not cost much performance when combined with the distortion pass. For reasonably complex scenes, this can be done with much less computation than rendering a whole new frame.</p>
</blockquote>
<p><strong>æ—¶é—´æ‰­æ›²ã€å¼‚æ­¥æ—¶é—´æ‰­æ›²å’ŒæŠ–åŠ¨</strong></p>
<p>TWæ˜¯ä¸€ç§æŠ€æœ¯ï¼Œåœ¨é€æ˜¾ä¹‹å‰å°†æ¸²æŸ“è¿‡çš„å›¾åƒæ‰­æ›²ï¼Œä»è€Œçº æ­£åœºæ™¯æ¸²æŸ“åï¼ˆæ¸²æŸ“ååˆ°é€æ˜¾å‰è¿™ä¸€æ®µï¼‰å‘ç”Ÿçš„å¤´éƒ¨è¿åŠ¨ï¼Œå‡å°‘æ„ŸçŸ¥å»¶è¿Ÿã€‚æœ€åŸºç¡€çš„æ—¶é—´æ‰­æ›²æ˜¯åŸºäºæœå‘ï¼ˆå¤´éƒ¨ï¼‰çš„ï¼Œè¿™ç§æ–¹å¼åªå¯¹å¤´éƒ¨å§¿åŠ¿çš„æ—‹è½¬å˜åŒ–è¿›è¡Œäº†æ ¡æ­£ã€‚è¿™ç§æ–¹æ³•çš„æ˜¾è‘—ä¼˜ç‚¹æ˜¯è¿™æ˜¯äºŒç»´çš„æ‰­æ›²ï¼Œåœ¨ä¸ç•¸å˜çŸ«æ­£ç»“åˆæ—¶ä¸ä¼šå¤ªå½±å“æ€§èƒ½ã€‚å¯¹äºç›¸å½“å¤æ‚çš„åœºæ™¯ï¼Œè¿™æ¯”æ¸²æŸ“ä¸€å¸§å…¨æ–°ç”»é¢æ‰€éœ€çš„è®¡ç®—é‡è¦å°‘å¾—å¤šã€‚</p>
<blockquote>
<p>Asynchronous timewarp refers to doing this on another thread in parallel (i.e. asynchronously) with rendering. Before every vsync, the ATW thread generates a new timewarped frame from the latest frame completed by the rendering thread.</p>
</blockquote>
<p>ATWæ˜¯æŒ‡åœ¨ä¸€æ¡å’Œæ¸²æŸ“çº¿ç¨‹å¹¶è¡Œçš„ï¼ˆæ‰­æ›²ï¼‰çº¿ç¨‹ä¸Šå·¥ä½œã€‚åœ¨æ¯æ¬¡VSyncä¹‹å‰ï¼ŒATWçº¿ç¨‹åŸºäºæ¸²æŸ“çº¿ç¨‹å®Œæˆçš„æœ€æ–°å¸§ç”Ÿæˆä¸€å¸§æ‰­æ›²è¿‡çš„å¸§ã€‚</p>
<blockquote>
<p>Judder and its consequences are covered in detail by Michael Abrash in his <a target="_blank" rel="noopener" href="http://blogs.valvesoftware.com/abrash/">2013 blog posts here</a>. Reviewing Michaelâ€™s notes on judder would be helpful to get the most out of this post.</p>
</blockquote>
<p>Michael Abrashï¼ˆä½œè€…æœ¬äººï¼‰åœ¨å…¶ 2013 å¹´çš„åšæ–‡ï¼ˆåŸæ–‡ä¸­è´´çš„é“¾æ¥å·²å¤±æ•ˆï¼‰ä¸­è¯¦ç»†ä»‹ç»äº†æŠ–åŠ¨åŠå…¶åæœã€‚é˜…è¯»è¿ˆå…‹å°”å…³äºæŠ–åŠ¨çš„ç¬”è®°å°†æœ‰åŠ©äºæ‚¨æ›´å¥½åœ°ç†è§£æœ¬ç¯‡æ–‡ç« ã€‚</p>
<blockquote>
<p>In order to produce a perceptually correct representation of the virtual world, the images on the displays must be updated with every vsync refresh. However, if rendering takes too long, a frame will be missed, resulting in judder. This is because when no new frame has been rendered, the video adapter scans out the same image a second time. Here is what an object location looks like if the same rendered frame is displayed two frames in a row before updating:</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/double-image-judder.jpg" alt=""></p>
<p><em>Here, the eye is rotating to the left. When the same image is displayed again, its light falls on a different part of the retina, resulting in double image judder.</em></p>
</blockquote>
<p>ä¸ºäº†åœ¨è™šæ‹Ÿä¸–ç•Œå‘ˆç°æ­£ç¡®çš„æ„ŸçŸ¥ï¼Œå±å¹•å›¾åƒå¿…é¡»åœ¨æ¯æ¬¡VSyncæ—¶åˆ·æ–°ã€‚ç„¶è€Œï¼Œå¦‚æœæ¸²æŸ“è€—è´¹å¤ªé•¿æ—¶é—´ï¼Œå°±ä¼šé”™è¿‡ä¸€å¸§ï¼Œè¿™å°±å¯¼è‡´äº†æŠ–åŠ¨ã€‚è¿™æ˜¯å› ä¸ºå½“æ²¡æœ‰æ¸²æŸ“æ–°çš„å¸§æ—¶ï¼Œè§†é¢‘é€‚é…å™¨å¯¹åŒä¸€å¼ å›¾åƒè¿›è¡Œäº†äºŒæ¬¡æ‰«æã€‚åœ¨æ›´æ–°å‰è¿ç»­æ˜¾ç¤ºåŒä¸€æ¸²æŸ“å¸§æ—¶ï¼Œå¯¹è±¡ä½ç½®çš„æƒ…å†µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/double-image-judder.jpg" alt=""></p>
<p><em>åœ¨è¿™é‡Œï¼Œçœ¼ç›å‘å·¦æ—‹è½¬ã€‚å½“å†æ¬¡æ˜¾ç¤ºåŒä¸€å›¾åƒæ—¶ï¼Œå…‰çº¿è½åœ¨è§†ç½‘è†œçš„ä¸åŒéƒ¨åˆ†ï¼Œå¯¼è‡´é‡å½±æŠ–åŠ¨ã€‚</em></p>
<blockquote>
<p>Of course, doubling is not the only possible effect. If we displayed the same frame three times in a row, you would get a triple image on your retina and so on.</p>
</blockquote>
<p>å½“ç„¶ï¼Œé‡å½±ä¸æ˜¯å”¯ä¸€å¯èƒ½çš„æ•ˆæœã€‚å¦‚æœæˆ‘ä»¬è¿ç»­æ˜¾ç¤ºåŒä¸€å¸§ä¸‰æ¬¡ï¼Œä½ ä¼šçœ‹åˆ°ä¸‰é‡å›¾åƒï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<blockquote>
<p>Orientation-only ATW can be used to help address judder: if the rendered game frame is not submitted before vsync, timewarp can interrupt and generate the image instead, by warping the last frame to reflect the head motion since the last frame was rendered. Although this new image will not be exactly correct, it will have been adjusted for head rotation, so displaying it will reduce judder as compared to displaying the original frame again, which is what would have happened without ATW.</p>
</blockquote>
<p>åŸºäºæ–¹å‘çš„ATWå¯ä»¥å¸®åŠ©è§£å†³æŠ–åŠ¨é—®é¢˜ï¼šå¦‚æœæ¸²æŸ“çš„æ¸¸æˆå¸§æ²¡æœ‰åœ¨VSyncåˆ°æ¥å‰æäº¤ï¼ŒTWä¼šä¸­æ–­ï¼ˆæ¸²æŸ“çº¿ç¨‹ï¼‰å¹¶ç”Ÿæˆå›¾åƒï¼Œé€šè¿‡æ‰­æ›²æœ€åä¸€å¸§æ¥ä»£è¡¨æœ€åä¸€å¸§ä»¥æ¥çš„å¤´éƒ¨è¿åŠ¨ã€‚è™½ç„¶æ–°çš„å›¾åƒå¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œä½†å®ƒå·²ç»æ ¹æ®å¤´éƒ¨æ—‹è½¬è¿›è¡Œäº†è°ƒæ•´ï¼Œå› æ­¤æ˜¾ç¤ºè¿™ä¸€å¸§ï¼ˆæ‰­æ›²ç”Ÿæˆçš„å¸§ï¼‰ç›¸æ¯”åœ¨æ²¡æœ‰ATWçš„æƒ…å†µä¸‹æ˜¾ç¤ºåŒä¸€å¸§ï¼ˆä¸Šä¸€å¸§ï¼‰ï¼Œå¯ä»¥å‡å°‘æŠ–åŠ¨ã€‚</p>
<blockquote>
<p>In certain situations, simple rotation-warping can work well. It has been implemented on Gear VR Innovator Edition, where it fills in the frames whenever games canâ€™t meet the frame rate. This smooths many glitches to the point where theyâ€™re mostly not noticeable. Because Gear VR lacks position tracking and the content generally avoids near-field objects, many of the artifacts discussed below are lessened or avoided.</p>
</blockquote>
<p>åœ¨æŸäº›ç¡®å®šçš„åœºæ™¯ä¸‹ï¼Œç®€å•çš„æ—‹è½¬-æ‰­æ›²æ•ˆæœä¼šå¾ˆå¥½ã€‚åœ¨Gear VRåˆ›æ–°ç‰ˆä¸Šå·²ç»å®ç°ï¼šå½“æ¸¸æˆå¸§æ— æ³•æ»¡è¶³è¦æ±‚æ—¶ï¼Œå®ƒå°±ä¼šå¡«å……å¸§æ•°ã€‚è¿™ä½¿è®¸å¤šæ•…éšœå˜å¾—å¹³æ»‘ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä¸æ˜“å¯Ÿè§‰ã€‚ç”±äº Gear VR ç¼ºä¹ä½ç½®è·Ÿè¸ªåŠŸèƒ½ï¼Œè€Œä¸”å†…å®¹ä¸€èˆ¬éƒ½ä¼šé¿å¼€è¿‘åœºç‰©ä½“ï¼Œå› æ­¤ä¸‹é¢è®¨è®ºçš„è®¸å¤šå‡è±¡éƒ½ä¼šå‡å°‘æˆ–é¿å…ã€‚</p>
<p>ï¼ˆåœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼Œæˆ‘ä»¬ä»¥ç»˜åˆ¶å‡ºä»¥å‡ä¹±çœŸçš„å›¾æ™¯ä¸ºç›®æ ‡ï¼Œä½†æ˜¯ç»å¸¸ä¼šç»˜åˆ¶å‡ºæ¥é”¯é½¿çŠ¶è¾¹ç¼˜ï¼Œæˆ–è€…ä¸€äº›é¢œè‰²é”™è¯¯ï¼Œæˆ‘ä»¬ä¼šç§°ä¹‹ä¸º<strong>artifact</strong>ï¼Œæ„æ€æ˜¯è¿™é‡Œç»˜åˆ¶å¾—ä¸è‡ªç„¶ï¼‰</p>
<blockquote>
<p>There are several reasons why ATW on the PC is significantly more challenging than on Gear VR, starting with the Riftâ€™s support for positional tracking.</p>
</blockquote>
<p>PC ä¸Šçš„ ATW æ¯” Gear VR ä¸Šçš„æ›´å…·æŒ‘æˆ˜æ€§ï¼ŒåŸå› æœ‰å‡ ä¸ªï¼Œé¦–å…ˆæ˜¯ Rift æ”¯æŒå®šä½è¿½è¸ªã€‚</p>
<blockquote>
<p><strong>Positional Judder</strong></p>
<p>Positional judder is one of the most obvious artifacts with orientation-only timewarp. When you move your head, only the additional rotational component is reflected in the ATW-generated images, while any translational head movement since the frame was rendered is ignored. This means that as you move your head from side to side, or even just rotate your head which translates your eyes, you will see multiple-image judder on objects that are close to you. The effect is very noticeable in spaces with near field objects, such as the submarine screenshot below.</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/multiple-image-judder-with-near-field-objects.jpg" alt=""></p>
</blockquote>
<p><strong>ä½ç½®æŠ–åŠ¨</strong></p>
<p>ä½ç½®æŠ–åŠ¨æ˜¯åŸºäºæ–¹å‘çš„æ—¶é—´æ‰­æ›²å¸¦æ¥çš„æœ€æ˜æ˜¾çš„ç‘•ç–µä¹‹ä¸€ã€‚å½“ç§»åŠ¨å¤´éƒ¨æ—¶ï¼Œåªæœ‰é¢å¤–çš„æ—‹è½¬éƒ¨åˆ†ä¼šåæ˜ åœ¨ATWç”Ÿæˆçš„å›¾åƒä¸­ï¼Œè€Œè‡ªå¸§è¢«æ¸²æŸ“ä»¥æ¥çš„æ‰€æœ‰å¤´éƒ¨å¹³ç§»éƒ½ä¼šè¢«å¿½ç•¥ã€‚è¿™å°±æ„å‘³ç€å½“å·¦å³ç§»åŠ¨å¤´éƒ¨ï¼Œç”šè‡³åªæ˜¯æ—‹è½¬å¤´éƒ¨ä½¿çœ¼ç›å¹³ç§»æ—¶ï¼Œå°†åœ¨é è¿‘çš„ç‰©ä½“ä¸Šè§‚å¯Ÿåˆ°å¤šé‡å›¾åƒæŠ–åŠ¨ã€‚è¿™ç§æ•ˆæœåœ¨æœ‰è¿‘åœºç‰©ä½“æ—¶éå¸¸æ˜æ˜¾ï¼Œä¾‹å¦‚ä¸‹é¢çš„æ½œè‰‡æˆªå›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/multiple-image-judder-with-near-field-objects.jpg" alt=""></p>
<blockquote>
<p>So, how bad is this effect?</p>
<p>The magnitude of positional judder depends on the environment the player is in and the types of movements they make. If you keep your head relatively still and only look around at the scenery, the positional error will be small and the judder will not be very noticeable.</p>
<p><strong>Note:</strong> This is normally the case for Gear VR Innovator Edition, which doesnâ€™t include positional tracking. Nevertheless, the head model generates virtual translations, so when a game is running at half-rate on Gear VR, you can still observe positional judder on near-field objects.</p>
</blockquote>
<p>é‚£ä¹ˆï¼Œè¿™ç§å½±å“æœ‰å¤šä¸¥é‡ï¼Ÿ</p>
<p>ä½ç½®æŠ–åŠ¨çš„ç¨‹åº¦å–å†³äºç©å®¶æ‰€å¤„çš„ç¯å¢ƒå’Œæ‰€åšçš„åŠ¨ä½œç±»å‹ã€‚å¦‚æœä½ çš„å¤´éƒ¨ä¿æŒç›¸å¯¹é™æ­¢ï¼Œåªæ˜¯ç¯é¡¾å››å‘¨çš„æ™¯ç‰©ï¼Œé‚£ä¹ˆä½ç½®è¯¯å·®ä¼šå¾ˆå°ï¼ŒæŠ–åŠ¨ä¹Ÿä¸ä¼šå¾ˆæ˜æ˜¾ã€‚ï¼ˆè¯´ç™½äº†å°±æ˜¯ä¸åšå¤´éƒ¨å¹³ç§»ï¼Ÿï¼‰</p>
<p><strong>æ³¨æ„</strong>ï¼šGear VR åˆ›æ–°ç‰ˆé€šå¸¸å°±æ˜¯è¿™ç§æƒ…å†µï¼Œå› ä¸ºå®ƒä¸åŒ…å«ä½ç½®è·Ÿè¸ªåŠŸèƒ½ã€‚ä¸è¿‡ï¼Œå¤´éƒ¨æ¨¡å‹ä¼šäº§ç”Ÿè™šæ‹Ÿå¹³ç§»ï¼Œå› æ­¤å½“æ¸¸æˆåœ¨ Gear VR ä¸Šä»¥åŠé€Ÿç‡è¿è¡Œæ—¶ï¼Œæ‚¨ä»ç„¶å¯ä»¥è§‚å¯Ÿåˆ°è¿‘åœºç‰©ä½“çš„ä½ç½®æŠ–åŠ¨ã€‚</p>
<blockquote>
<p>If youâ€™re looking at objects far away, the displacement change due to your head movement is unlikely to be significant enough to be noticeable. In these cases, ATW allows you to look around a scene with mid-to-far-field geometry without any noticeable judder.</p>
<p>On the other hand, if youâ€™re in a environment with near-field detail, and you translate your head, the positional judder will be nearly as bad as running without ATW. This will also be true when you look down at a textured ground plane, which is not far enough away to avoid artifacts. The resulting perceptual effect is that of a glitchy, unstable world, which can be disorienting and uncomfortable.</p>
</blockquote>
<p>å¦‚æœä½ æ­£åœ¨çœ‹è¿œå¤„çš„ç‰©ä½“ï¼Œå¤´éƒ¨ç§»åŠ¨é€ æˆçš„ä½ç§»å˜åŒ–ä¸å¤ªå¯èƒ½å¤§åˆ°è¶³ä»¥å¼•èµ·æ³¨æ„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒATWä½¿ä½ ç¯è§†å¸¦æœ‰ä¸­è¿œæ™¯å‡ ä½•å›¾å½¢çš„åœºæ™¯è€Œä¸å¼•èµ·æ˜æ˜¾çš„æŠ–åŠ¨ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå¤„äºå¸¦æœ‰è¿‘æ™¯ç»†èŠ‚çš„ç¯å¢ƒï¼Œå¹¶ä¸”ç§»åŠ¨äº†å¤´éƒ¨ï¼Œé‚£ä¹ˆä½ç½®æŠ–åŠ¨å°†ä¸ä¸ä½¿ç”¨ATWæ—¶ä¸€æ ·ä¸¥é‡ã€‚ä½å¤´çœ‹æœ‰çº¹ç†çš„åœ°é¢ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å› ä¸ºè·ç¦»ä¸å¤Ÿè¿œï¼Œæ— æ³•é¿å…ä¼ªå½±ã€‚ç”±æ­¤äº§ç”Ÿçš„æ„ŸçŸ¥æ•ˆæœæ˜¯ä¸€ä¸ªé—ªçƒã€ä¸ç¨³å®šçš„æ—¶é—´ï¼Œä¼šè®©äººè¿·å¤±æ–¹å‘ï¼Œæ„Ÿåˆ°ä¸èˆ’æœã€‚</p>
<blockquote>
<p><strong>Positional Timewarp</strong></p>
<p>One possible way to address positional judder is to implement full positional warping, which applies both translation and orientation fixups to the original rendered frame. Positional warping needs to consider the depth of the original rendered frame, displacing parts of the image by different amounts. However, such displacement generates dis-occlusion artifacts at object edges, where areas of space are uncovered that donâ€™t have data in the original frame.</p>
<p>Additionally, positional warping is more expensive, canâ€™t easily handle translucency, has trouble with certain anti-aliasing approaches, and doesnâ€™t address the other ATW artifacts discussed below.\</p>
</blockquote>
<p><strong>ä½ç½®æ‰­æ›²</strong></p>
<p>è§£å†³ä½ç½®æŠ–åŠ¨çš„ä¸€ç§å¯èƒ½çš„æ–¹æ³•ä¸ºå®ç°å…¨ä½ç½®æ‰­æ›²ï¼Œå¯¹åŸå§‹æ¸²æŸ“å¸§è¿›è¡Œæ–¹å‘ï¼ˆæœå‘ï¼‰å’Œå¹³ç§»ä¿®æ­£ã€‚ä½ç½®æ‰­æ›²éœ€è¦è€ƒè™‘åŸå§‹æ¸²æŸ“å¸§çš„æ·±åº¦ä¿¡æ¯ï¼Œå¯¹å›¾åƒçš„ä¸åŒéƒ¨åˆ†è¿›è¡Œä¸åŒç¨‹åº¦çš„ä½ç§»ã€‚ç„¶è€Œï¼Œè¿™æ ·äº§ç”Ÿçš„ä¸­é—´å¸§ä¼šä½¿ç‰©ä½“è¾¹ç¼˜ä¸é—­åˆï¼Œç”±äºæ²¡æœ‰åŸå§‹å¸§ä¸­çš„æ•°æ®ï¼Œä¼šå¯¼è‡´ä¸­é—´å¸§æŸäº›åŒºåŸŸä¸èƒ½è¢«è¦†ç›–ã€‚</p>
<p>æ­¤å¤–ï¼Œä½ç½®æ‰­æ›²æˆæœ¬æ›´é«˜ï¼Œæ— æ³•è½»æ¾å¤„ç†åŠé€æ˜æ•ˆæœï¼Œåœ¨ä½¿ç”¨æŸäº›æŠ—é”¯é½¿æ–¹æ³•æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œè€Œä¸”æ— æ³•è§£å†³ä¸‹æ–‡ä¸­è®¨è®ºçš„å…¶ä»–ATWçš„æƒ…å½¢ã€‚</p>
<blockquote>
<p><strong>Moving and Animated Objects</strong></p>
<p>Animated or moving objects cause another artifact with ATW: because a new image is generated just by warping the original image without knowledge of the movement of objects, for all ATW-generated frames they are effectively frozen in time. This artifact manifests as multiple images of these moving objects â€” i.e. judder.</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/moving-object-affected-by-judder.jpg" alt=""></p>
<center>Image of scene with a moving object affected by judder.</center>
</blockquote>
<p><strong>ç§»åŠ¨å’ŒåŠ¨ç”»ç‰©ä½“</strong></p>
<p>åŠ¨ç”»æˆ–ç§»åŠ¨ä¸­çš„ç‰©ä½“å¯¼è‡´äº†å¦ä¸€ä¸ªATWä¸­çš„ç‘•ç–µï¼šç”±äºæ–°å›¾åƒæ˜¯åœ¨ä¸çŸ¥é“ç‰©ä½“ç§»åŠ¨çš„æƒ…å†µä¸‹é€šè¿‡æ‰­æ›²åŸå§‹å›¾åƒç”Ÿæˆçš„ï¼Œå› æ­¤åœ¨æ‰€æœ‰ATWç”Ÿæˆçš„å¸§ä¸­ï¼Œè¿™äº›ç‰©ä½“å®é™…ä¸Šéƒ½è¢«å†»ç»“åœ¨æ—¶é—´ä¸­ã€‚è¿™ç§ä¼ªåƒè¡¨ç°ä¸ºè¿™äº›ç§»åŠ¨ç‰©ä½“çš„å¤šå¹…å›¾åƒï¼Œå³æŠ–åŠ¨ã€‚</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/moving-object-affected-by-judder.jpg" alt=""></p>
<center>Image of scene with a moving object affected by judder.</center>
<blockquote>
<p>The impact of this artifact depends on the number, projected area, and speed of animated objects in the game scene: if the number or size of moving objects is small or they are not moving fast, the multiple images may not be particularly noticeable. However, when moving objects or animation covers a large portion of the screen it can be disturbing.</p>
<p>Additionally, the frame rate ratio between the game rendering and device refresh rate affects the perceived quality of the motion judder. In our experience, ATW should run at a fixed fraction of the game frame rate. For example, at 90Hz refresh rate, we should either hit 90Hz or fall down to the half-rate of 45Hz with ATW. This will result in image doubling, but the relative positions of the double images on the retina will be stable. Rendering at an intermediate rate, such as 65Hz, will result in a constantly changing number and position of the images on the retina, which is a worse artifact.</p>
</blockquote>
<p>è¿™ç§ä¼ªå½±çš„å½±å“å–å†³äºæ¸¸æˆåœºæ™¯ä¸­åŠ¨ç”»çš„æ•°é‡ã€æŠ•å½±é¢ç§¯å’Œé€Ÿåº¦ï¼šå¦‚æœæ­£åœ¨ç§»åŠ¨çš„ç‰©ä½“çš„æ•°é‡è¾ƒå°‘æˆ–å½¢çŠ¶è¾ƒå°æˆ–ç§»åŠ¨é€Ÿåº¦ä¸å¿«ï¼Œé‚£ä¹ˆé‡å½±å¯èƒ½ä¸ä¼šå¤ªæ˜æ˜¾ã€‚ä½†æ˜¯ï¼Œå½“ç§»åŠ¨çš„ç‰©ä½“æˆ–åŠ¨ç”»å æ®äº†å±å¹•çš„å¤§éƒ¨åˆ†åŒºåŸŸï¼Œå°±ä¼šé€ æˆå¹²æ‰°ã€‚</p>
<p>æ­¤å¤–ï¼Œæ¸¸æˆæ¸²æŸ“å¸§ç‡å’Œå±å¹•åˆ·æ–°ç‡ä¹‹é—´çš„æ¯”å€¼ä¹Ÿä¼šå½±å“æŠ–åŠ¨çš„æ„ŸçŸ¥è´¨é‡ã€‚æ ¹æ®ç»éªŒï¼ŒATWåº”è¯¥ä»¥æ¸¸æˆå¸§ç‡çš„å›ºå®šæ¯”ä¾‹è¿è¡Œã€‚ä¾‹å¦‚ï¼Œåœ¨90èµ«å…¹çš„åˆ·æ–°ç‡ä¸‹ï¼ŒATWè¦ä¹ˆè¾¾åˆ°90Hzï¼Œè¦ä¹ˆé™åˆ°45Hzè¿è¡Œã€‚è¿™å°†å¯¼è‡´å›¾åƒåŠ å€ï¼Œä½†åŒå›¾åƒåœ¨è§†ç½‘è†œä¸Šçš„ç›¸å¯¹ä½ç½®å°†ä¿æŒç¨³å®šã€‚ä»¥65Hzè¿™æ ·çš„ä¸­é—´å¸§ç‡æ¸²æŸ“ä¼šå¯¼è‡´è§†ç½‘è†œä¸Šå›¾åƒçš„æ•°é‡å’Œä½ç½®ä¸æ–­æ”¹å˜ï¼Œä»è€Œäº§ç”Ÿæ›´ç³Ÿç³•çš„ä¼ªå½±ã€‚</p>
<blockquote>
<p><strong>Specular and Reflection</strong></p>
<p>Calculations for reflections and specular lighting consider the direction of the eye vector, or rendering camera vector, to produce an image that is custom rendered for each eye.</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection2.jpg" alt=""></p>
</blockquote>
<p><strong>é•œé¢åå°„</strong></p>
<p>è®¡ç®—é•œé¢åå°„éœ€è€ƒè™‘çœ¼ç›çš„æ–¹å‘ï¼Œ æˆ–æ‘„åƒæœºï¼ˆUnityé‡Œçš„cameraï¼Ÿï¼‰çš„æ–¹å‘ï¼Œ ç”±æ­¤ä¸ºæ¯åªçœ¼ç›ç”Ÿæˆä¸€å¼ å®šåˆ¶çš„æ¸²æŸ“ç”»é¢ã€‚</p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/treeknows/blog_pic/master/imgs/specular-and-reflection2.jpg" alt=""></p>
<blockquote>
<p><em>Diagrams courtesy of Wikipedia and <a target="_blank" rel="noopener" href="http://ogldev.atspace.co.uk/www/tutorial19/tutorial19.html">http://ogldev.atspace.co.uk/www/tutorial19/tutorial19.html</a> respectively.</em></p>
<p>Since this eye vector changes with head movement, specular and reflection rendering is no longer correct after timewarp. This may result in reflections and specular highlights juddering.</p>
<p>While specular highlights and reflections are two of the most common cases where shading relies on the eye vector, many other eye vector-dependent shading tricks will have similar issues. For example, parallax mapping and relief mapping (aka. parallax occlusion mapping) will show similar artifacts.</p>
</blockquote>
<p>å›¾ç‰‡æ¥è‡ªç»´åŸºç™¾ç§‘å’Œ<a target="_blank" rel="noopener" href="http://ogldev.atspace.co.uk/www/tutorial19/tutorial19.html">ç½‘ç«™</a></p>
<p>ç”±äºçœ¼ç›å‘é‡ï¼ˆï¼Ÿï¼‰ä¼šéšç€å¤´éƒ¨è¿åŠ¨è€Œæ”¹å˜ï¼Œå› æ­¤åœ¨TWåï¼Œé•œé¢åå°„æ¸²æŸ“å°†ä¸å†æ­£ç¡®ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´é•œé¢åå°„æŠ–åŠ¨ã€‚</p>
<p>è™½ç„¶é•œé¢é«˜å…‰å’Œåå°„æ˜¯ä¾é çœ¼çƒçŸ¢é‡ç€è‰²çš„ä¸¤ç§æœ€å¸¸è§æƒ…å†µï¼Œè®¸å¤šå…¶ä»–ä¾èµ–çœ¼çƒå‘é‡çš„ç€è‰²æŠ€å·§ä¹Ÿæœ‰ç±»ä¼¼çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œè§†å·®è´´å›¾å’Œæµ®é›•æ˜ å°„(åˆç§°ä¸ºè§†å·®é®æŒ¡æ˜ å°„)ä¹Ÿä¼šæœ‰ç±»ä¼¼çš„ç°è±¡ã€‚</p>
<blockquote>
<p><strong>Implementation</strong></p>
<p>Implementing ATW is challenging for two primary reasons:</p>
<ul>
<li>It requires GPU HW to support preemption at reasonable granularity</li>
<li>It requires OS and driver support to expose GPU preemption</li>
</ul>
<p>Letâ€™s start with preemption granularity. At 90Hz, the interval between frames is roughly 11ms. This means that in order for ATW to have any chance of generating a frame, it must be able to preempt the main thread rendering commands and run in under 11ms.</p>
</blockquote>
<p><strong>ATWå®ç°</strong></p>
<p>å®ç°ATWæœ‰ä¸¤ä¸ªä¸»è¦çš„æŠ€æœ¯æŒ‘æˆ˜ï¼š</p>
<ul>
<li>éœ€è¦GPUç¡¬ä»¶ä»¥åˆç†çš„ç²’åº¦æ”¯æŒæŠ¢å </li>
<li>éœ€è¦æ“ä½œç³»ç»Ÿå’Œé©±åŠ¨æ”¯æŒGPUæŠ¢å </li>
</ul>
<p>è®©æˆ‘ä»¬ä»æŠ¢å ç²’åº¦å¼€å§‹ã€‚åœ¨90Hzæ—¶ï¼Œå¸§é—´éš”å¤§çº¦æ˜¯11msã€‚è¿™æ„å‘³ç€ä¸ºäº†ä½¿ATWèƒ½æœ‰æœºä¼šç”Ÿæˆä¸€å¸§ï¼Œå¿…é¡»èƒ½å¤ŸæŠ¢å ä¸»çº¿ç¨‹çš„æ¸²æŸ“å‘½ä»¤ï¼Œå¹¶åœ¨11mså†…è¿è¡Œã€‚</p>
<blockquote>
<p>However, 11ms isnâ€™t actually good enough â€” If ATW runs at randomly scheduled points within the frame, its latency (ie. the amount of time between execution and frame scan-out) will also be random. And, we need to make sure we donâ€™t skip any game-rendered frames.</p>
<p>What we really want is for ATW to run consistently shortly before the video card flips to a new frame for scan-out, with just enough time to complete the generation of the new timewarped frame. Short of having custom vsync-triggered ATW interrupt routines, we can achieve this with high-priority preemption granularity and scheduling of around 2ms or less.</p>
</blockquote>
<p>ç„¶è€Œï¼Œ11mså®é™…ä¸Šè¿˜ä¸å¤Ÿå¥½ï¼šå¦‚æœATWåœ¨ä¸€å¸§å†…éšæœºçš„æ—¶é—´ç‚¹å¼€å§‹è¿è¡Œï¼Œå…¶å»¶è¿Ÿ(æ‰§è¡Œå’Œå¸§æ‰«æä¹‹é—´çš„æ—¶é—´é—´éš”)ä¹Ÿå°†æ˜¯éšæœºçš„ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸ä¼šè°ƒè¿‡ä»»ä½•æ¸¸æˆæ¸²æŸ“çš„å¸§ã€‚</p>
<p>æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ATWèƒ½å¤Ÿæœ‰åˆšåˆšè¶³å¤Ÿçš„æ—¶é—´ï¼Œåœ¨æ˜¾å¡åˆ‡åˆ°æ–°å¸§æ‰«æè¾“å‡ºå‰ç»“æŸç”Ÿæˆæ–°çš„ä¸€å¸§ã€‚å¦‚æœä¸ä½¿ç”¨å®šåˆ¶çš„å‚ç›´åŒæ­¥è§¦å‘çš„ATWä¸­æ–­ä¾‹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é«˜ä¼˜å…ˆçº§çš„æŠ¢å æ€§è°ƒåº¦ï¼Œä»¥åŠå¤§çº¦2æ¯«ç§’æˆ–æ›´çŸ­çš„æ—¶é—´æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ï¼ˆå®ƒåœ¨è¯´å•¥ ğŸ˜…ï¼‰</p>
<blockquote>
<p>It turns out that 2ms preemption on general rendering is a tall order for modern video cards and driver implementations. Although many GPUs support limited forms of preemption, the implementation varies significantly:</p>
<ul>
<li>Some vendors and drivers allow preemption on either batch or draw call granularities. While helpful, this is not perfect (eg. in an extreme case, a single large draw call with a complex shader can easily take 10 ms).</li>
<li>Other vendors and drivers allow preemption of compute shaders, yet require vendor-specific extensions to support preemption of rendering with compute.</li>
</ul>
</blockquote>
<p>äº‹å®è¯æ˜ï¼Œå¯¹äºç°ä»£æ˜¾å¡åŠé©±åŠ¨å®ç°æ¥è®²ï¼Œåœ¨ä¸€èˆ¬çš„æ¸²æŸ“ä¸­å®ç°2msæŠ¢å æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ã€‚è™½ç„¶è®¸å¤šGPUéƒ½æ”¯æŒæœ‰é™å½¢å¼çš„æŠ¢å ï¼Œä½†å®ç°çš„æ–¹å¼ç¡®ä¸å°½ç›¸åŒã€‚</p>
<ul>
<li>ä¸€äº›ä¾›åº”å•†å’Œé©±åŠ¨å…è®¸åœ¨æ‰¹å¤„ç†æˆ–ç»˜åˆ¶è°ƒç”¨ç²’åº¦ä¸Šè¿›è¡ŒæŠ¢å ï¼Œè¿™è™½ç„¶æœ‰ç”¨ï¼Œä½†æ˜¯å¹¶ä¸å®Œç¾(ä¾‹å¦‚ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œå¤æ‚ç€è‰²å™¨çš„å•ä¸ªå¤§å‹ç»˜åˆ¶è°ƒç”¨å¯èƒ½è½»æ¾è€—è´¹10msæ—¶é—´)ã€‚</li>
<li>å…¶ä»–ä¾›åº”å•†å’Œé©±åŠ¨å…è®¸è®¡ç®—ç€è‰²å™¨çš„æŠ¢å ï¼Œä½†æ˜¯éœ€è¦ç‰¹å®šä¾›åº”å•†çš„æ‹“å±•æ¥æ”¯æŒè®¡ç®—æ¸²æŸ“çš„æŠ¢å ã€‚</li>
</ul>
<blockquote>
<p>If the preemption doesnâ€™t occur quickly enough, ATW will not complete warping a new frame before vsync, and the last frame will be shown again, resulting in judder. This means that a correct implementation should be able to preempt and resume rendering arbitrarily, regardless of the pipeline state. In theory, even triangle-granularity preemption is not good enough because with complex shaders we donâ€™t know how long rendering a triangle will take. Weâ€™re working with GPU manufacturers to implement better preemption, but it will be awhile before itâ€™s ubiquitous.</p>
<p>Another part of the equation is rendering preemption support in the OS. Prior to Windows 8, Windows Display Driver Model (WDDM) supported limited preemption using â€œbatch queueâ€ granularity, where batches were built by the graphics driver. Unfortunately, graphics drivers tend to accumulate large batches for rendering efficiency, resulting in preemption that is too coarse to support ATW well.</p>
<p>With Windows 8, the situation improved as WDDM 1.2 added support for preemption at finer granularities; however, these preemption modes are currently not universally supported by graphics drivers. Rendering pipeline management is expected to improve significantly with Windows 10 and DirectX 12, which gives developers lower-level rendering control. This is good news, but weâ€™re still left without a standard way to support rendering preemption until Windows 10 becomes mainstream. As a result, ATW will require vendor-specific driver extensions for the foreseeable future.</p>
</blockquote>
<p>å¦‚æœæŠ¢å åŠ¨ä½œä¸å¤Ÿå¿«ï¼ŒATWå°†æ— æ³•åœ¨VSyncåˆ°æ¥å‰æ‰­æ›²ç”Ÿæˆæ–°çš„å¸§ï¼Œæœ€åä¸€å¸§å°†å†æ¬¡æ˜¾ç¤ºï¼Œå¯¼è‡´æŠ–åŠ¨ã€‚è¿™å°±æ„å‘³ç€æ— è®ºæµæ°´çº¿çš„çŠ¶æ€å¦‚ä½•ï¼Œæ­£ç¡®çš„å®ç°éƒ½åº”è¯¥èƒ½å¤Ÿéšæ„çš„æŠ¢å å’Œæ¸²æŸ“ã€‚ç†è®ºä¸Šï¼Œå³ä¾¿æ˜¯ä¸‰è§’ç²’åº¦æŠ¢å ï¼ˆ&lt;â€“æ²¡å¤ªæ˜ç™½æ˜¯ä¸ªå•¥ï¼‰ä¹Ÿä¸å¤Ÿå¥½ï¼Œå› ä¸ºå¯¹äºå¤æ‚ç€è‰²å™¨ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢éœ€è¦å¤šé•¿æ—¶é—´ã€‚æˆ‘ä»¬æ­£ä¸GPUåˆ¶é€ å•†åˆä½œï¼Œå®ç°æ›´å¥½çš„æŠ¢å åŠŸèƒ½ï¼Œä½†è¦æƒ³æ™®åŠè¿˜éœ€è¦ä¸€æ®µæ—¶é—´ã€‚</p>
<p>å¦ä¸€ä¸ªå› ç´ æ˜¯æ“ä½œç³»ç»Ÿå¯¹æ¸²æŸ“æŠ¢å çš„æ”¯æŒï¼ˆequation æ–¹ç¨‹å¼ï¼‰ã€‚åœ¨Win8ä¹‹å‰ï¼ŒWindowsæ˜¾ç¤ºé©±åŠ¨ç¨‹åºæ¨¡å‹(WDDM)æ”¯æŒä½¿ç”¨â€œæ‰¹é˜Ÿåˆ—â€ç²’åº¦çš„æœ‰é™æŠ¢å ï¼Œå…¶ä¸­æ‰¹æ¬¡ç”±å›¾å½¢é©±åŠ¨ç¨‹åºæ„å»ºã€‚ä¸å¹¸çš„æ˜¯ï¼Œå›¾å½¢é©±åŠ¨å¾€å¾€ä¼šç§¯ç´¯å¤§é‡æ‰¹æ¬¡ä»¥æé«˜æ¸²æŸ“æ•ˆç‡ï¼Œè¿™å°±å¯¼è‡´æŠ¢å è¿‡äºç²—ç³™ï¼Œæ— æ³•å¾ˆå¥½åœ°æ”¯æŒATWã€‚</p>
<p>åœ¨Win8ä¸­ï¼Œæƒ…å†µæœ‰æ‰€æ”¹å–„ï¼Œå› ä¸ºWDDM1.2æ”¯æŒäº†æ›´ç»†ç²’åº¦çš„æŠ¢å ï¼›ä¸è¿‡è¿™äº›æŠ¢å æ¨¡å¼ç›®å‰è¿˜æ²¡æœ‰è¢«å›¾å½¢é©±åŠ¨ç¨‹åºæ™®éæ”¯æŒã€‚æ¸²æŸ“ç®¡çº¿ç®¡ç†é¢„è®¡å°†åœ¨Win10å’ŒDirectX 12ä¸Šæœ‰æ˜¾è‘—æ”¹å–„ï¼Œä¸ºå¼€å‘äººå‘˜æä¾›æ›´ä½çº§åˆ«çš„æ¸²æŸ“æ§åˆ¶ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œä½†æ˜¯åœ¨Win10æˆä¸ºä¸»æµä¹‹å‰æˆ‘ä»¬ä»ç„¶ç¼ºå°‘æ”¯æŒæ¸²æŸ“æŠ¢å çš„æ ‡å‡†æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨å¯è§çš„å°†æ¥ï¼ŒATWä»å°†ä¾èµ–ç‰¹å®šä¾›åº”å•†çš„é©±åŠ¨ç¨‹åºæ‹“å±•ã€‚</p>
<blockquote>
<p><strong>ATW is helpful, but itâ€™s not a silver bullet</strong></p>
<p>Once we have ubiquitous GPU rendering pipeline management and preemption, ATW may become another tool to help developers increase performance and reduce judder in VR. However, due to the issues and challenges weâ€™ve outlined here, ATW is not a silver bullet â€” VR applications will want to sustain high framerates to deliver the best quality of experience. In the worst cases, ATWâ€™s artifacts can cause users to have an uncomfortable experience. Or stated differently: in the worst cases, ATW canâ€™t prevent an experience from being uncomfortable.</p>
<p>Given the complexities and artifacts involved, itâ€™s clear that ATW, even with positional timewarp, wonâ€™t become a perfect universal solution. This means that both orientation-only and positional ATW are best thought of as pothole insurance, filling in when a frame is occasionally skipped. To deliver comfortable, compelling VR that truly generates presence, developers will still need to target a sustained frame rate of 90Hz+.</p>
</blockquote>
<p><strong>ATWæœ‰ç”¨ï¼Œä½†ä¸ä¸‡èƒ½</strong></p>
<p>ä¸€æ—¦æˆ‘ä»¬æ‹¥æœ‰äº†æ— å¤„ä¸åœ¨çš„GPUæ¸²æŸ“ç®¡çº¿ç®¡ç†å’ŒæŠ¢å ï¼ŒATWå¯èƒ½ä¼šæˆä¸ºå¸®åŠ©å¼€å‘è€…æå‡VRæ€§èƒ½ï¼Œå‡å°‘æŠ–åŠ¨çš„å¦ä¸€ç§å·¥å…·ã€‚ç„¶è€Œï¼ŒåŸºäºä¸Šè¿°çš„ä¸€äº›é—®é¢˜å’ŒæŒ‘æˆ˜ï¼ŒATWå¹¶ä¸æ˜¯ä¸‡èƒ½çš„â€”â€”VRåº”ç”¨æœŸæœ›ç»´æŒé«˜å¸§ç‡ä»¥æä¾›æœ€å¥½çš„ä½“éªŒæ•ˆæœã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼ŒATWçš„ä¼ªå½±å¯èƒ½å¯¼è‡´ç”¨æˆ·æœ‰ä¸èˆ’æœçš„ä½¿ç”¨ä½“éªŒã€‚æ¢å¥è¯è¯´ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼ŒATWæ— æ³•é˜»æ­¢ä½“éªŒå˜å¾—ä¸èˆ’æœã€‚</p>
<p>é‰´äºæ‰€æ¶‰åŠçš„å¤æ‚æ€§å’Œäººå·¥ç—•è¿¹ï¼Œå¾ˆæ˜æ˜¾å¯¹äºATWï¼Œç”šè‡³ä½ç½®æ‰­æ›²ï¼Œä¸ä¼šæˆä¸ºä¸€ä¸ªå®Œç¾çš„é€šç”¨è§£å†³æ–¹æ¡ˆã€‚è¿™å°±æ„å‘³ç€æ— è®º3dofçš„æ‰­æ›²è¿˜æ˜¯6dofçš„æ‰­æ›²æœ€å¥½ä½œä¸ºä¸€ä¸ªä¿é™©ï¼Œåœ¨å¶å°”è·³å¸§æ—¶å¡«è¡¥ç©ºç™½ã€‚æƒ³è¦æä¾›èˆ’é€‚ã€çœŸå®çš„VRä½“éªŒï¼Œå¼€å‘è€…ä»éœ€è¦å°†å¸§ç‡ä¿æŒåœ¨90Hzä»¥ä¸Šã€‚</p>
<blockquote>
<p>Thankfully, Crysis-level graphics are by no means required to deliver incredible VR experiences. Itâ€™s perfectly reasonable to reduce the number of lights, the shadow detail, and the shader complexity if it means reaching that 90Hz sweet spot.</p>
<p>Dual-mode titles that try to support traditional monitors and VR will have the most performance difficulties, as the steep performance requirements for good VR quickly become a challenge to engine scalability. For developers in this situation, ATW may look very attractive despite the artifacts. However, as is typical with new mediums, ports are unlikely to be the best experiences; made-for-VR experiences that target 90Hz are likely to be substantially more successful in generating comfort, presence, and the true magic of VR.</p>
<p>â€” Michael Antonov, Chief Software Architect</p>
</blockquote>
<p>å¹¸å¥½ï¼Œè¦æä¾›æƒŠè‰³çš„VRä½“éªŒï¼Œä¸éœ€è¦ã€Šå­¤å²›å±æœºã€‹çº§åˆ«çš„å›¾å½¢ã€‚åªè¦èƒ½å¤Ÿè¾¾åˆ°90Hzçš„æœ€ä½³é¢‘ç‡ï¼Œå‡å°‘ç¯å…‰æ•°é‡ã€é˜´å½±ç»†èŠ‚æˆ–ç€è‰²å™¨å¤æ‚åº¦éƒ½æ˜¯å®Œå…¨åˆç†çš„ã€‚</p>
<p>è¯•å›¾åŒæ—¶æ”¯æŒä¼ ç»Ÿæ˜¾ç¤ºå™¨å’ŒVRçš„åŒæ¨¡å¼æ¸¸æˆä¼šé‡åˆ°å¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºè‰¯å¥½çš„VRå¯¹æ€§èƒ½çš„å¾ˆå¿«å°±ä¼šæˆä¸ºå¯¹å¼•æ“å¯æ‹“å±•æ€§çš„æŒ‘æˆ˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹å¼€å‘è€…æ¥è¯´ATWä¼šæœ‰åè¶³çš„å¸å¼•åŠ›ï¼Œå°½ç®¡çœ‹èµ·æ¥ä¼šä¸è‡ªç„¶ã€‚ç„¶è€Œï¼Œä¸æ–°åª’ä½“çš„å…¸å‹æƒ…å†µä¸€æ ·ï¼Œç§»æ¤ä¸å¯èƒ½å¸¦æ¥æœ€ä½³ä½“éªŒï¼›ä»¥90Hzä¸ºç›®æ ‡çš„ä¸“é—¨çš„VRä½“éªŒå¯èƒ½ä¼šåœ¨äº§ç”Ÿèˆ’é€‚æ„Ÿã€ä¸´åœºæ„Ÿå’Œå…¶ä»–VRçš„ç¥å¥‡ä¹‹å¤„æ”¶è·æ›´å¤šçš„æˆåŠŸã€‚</p>
<p>â€”Michael Antonov, Chief Software Architect</p>
<hr>
<p>æ­£æ–‡ç»“æŸğŸ˜€</p>

    </div>
	 <!-- æ–‡ç« ç»“æŸè¡¨ç¤ºè¯­-->
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------------------------------------The End <i class="fa fa-tree" color="#66FFCC"></i>-------------------------------------------</div>
    
</div>

      
    </div>

    
    
    
      
  <div class="popular-posts-header">ç›¸å…³æ–‡ç« æ¨è</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\what-is-slam-algo\" rel="bookmark">è®¤è¯†SLAMç®—æ³•</a></div>
    </li>
  </ul>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>treeknows
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://treeknows.github.io/ATW-by-Michael-Antonov/" title="ATWæ¦‚è¿°-by Michael Antonov">https://treeknows.github.io/ATW-by-Michael-Antonov/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/XR/" rel="tag"><i class="fa fa-tag"></i> XR</a>
              <a href="/tags/Rendering/" rel="tag"><i class="fa fa-tag"></i> Rendering</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/what-is-slam-algo/" rel="prev" title="è®¤è¯†SLAMç®—æ³•">
      <i class="fa fa-chevron-left"></i> è®¤è¯†SLAMç®—æ³•
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="treeknows"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">treeknows</p>
  <div class="site-description" itemprop="description">Let me grow</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/treeknows/" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;treeknows&#x2F;" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/treeknows@qq.com" title="E-Mail â†’ treeknows@qq.com"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023 â€“ 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">treeknows</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">49k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">44 åˆ†é’Ÿ</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '32px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '22fb59ff85c3aef2677a',
      clientSecret: '246142feb132313b08ee3ff55678c88244b67b97',
      repo        : 'treeknows.github.io',
      owner       : 'treeknows',
      admin       : ['treeknows'],
      id          : 'e66e4bdaa4d865baf6b6f322352d6117',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
